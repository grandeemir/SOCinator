/*
    YARA Rule: Generic Malware Detection
    Description: Detects common malware signatures and patterns
    MITRE ATT&CK: T1055 (Process Injection), T1059 (Command and Scripting Interpreter)
    Severity: High
    False Positives: Legitimate software may trigger, requires manual review
*/

rule Malware_Generic_Signatures {
    meta:
        description = "Detects generic malware signatures"
        mitre_attack_id = "T1055, T1059"
        severity = "High"
        author = "SOCinator"
        date = "2024-01-01"
    
    strings:
        $s1 = "MZ" // PE header
        $s2 = "This program cannot be run in DOS mode"
        $s3 = /[0-9a-f]{32}/ // MD5-like hash
        $s4 = "cmd.exe /c"
        $s5 = "powershell"
        $s6 = "base64"
        
    condition:
        $s1 at 0 and 
        ($s2 or ($s4 and $s5) or ($s5 and $s6))
}

